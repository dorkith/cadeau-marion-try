<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Jeu du Mot Interdit</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0f0f23;
      color: #f2f2f2;
      padding: 20px;
      text-align: center;
    }
    .container {
      max-width: 700px;
      margin: auto;
    }
    input, button {
      width: 100%;
      padding: 12px;
      font-size: 1rem;
      margin-top: 10px;
    }
    button {
      background: #1f8a70;
      color: white;
      border: none;
      cursor: pointer;
    }
    .success { color: #4caf50; }
    .error { color: #f44336; }
    ul { padding-left: 0; list-style: none; }
    li {
      padding: 5px 0;
    }
    .rule-passed {
      color: #4caf50;
    }
    .rule-failed {
      color: #f44336;
    }
    .celebration {
      font-size: 2em;
      animation: pop 0.6s ease-out infinite alternate;
    }
    @keyframes pop {
      from { transform: scale(1); }
      to { transform: scale(1.1); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê Devine le mot interdit</h1>
    <h2>Chaque r√®gle compte. Respecte-les toutes pour gagner !</h2>

    <ul id="rulesList"></ul>

    <input id="answerInput" type="text" placeholder="Tape ta proposition ici...">
    <button id="submitBtn">Valider</button>

    <p id="message"></p>
    <p id="stats"></p>
  </div>

  <script>
    const rules = [
      { text: "Commence par une majuscule.", test: str => /^[A-Z√Ä√Ç√Ñ√â√à√ä√ã√è√é√î√ñ√ô√õ√ú√á]/.test(str) },
      { text: "Contient exactement 9 lettres.", test: str => str.replace(/[^a-zA-Z√Ä-√ø]/g, '').length === 9 },
      { text: "Ne contient aucun chiffre.", test: str => !/\d/.test(str) },
      { text: "Contient une lettre accentu√©e en deuxi√®me position.", test: str => /[√†√¢√§√©√®√™√´√Ø√Æ√¥√∂√π√ª√º√ß]/i.test(str[1]) },
      { text: "Ne contient pas la lettre z.", test: str => !/z/i.test(str) },
      { text: "Contient au moins deux lettres a.", test: str => (str.match(/a/gi) || []).length >= 2 },
      { text: "Ne se termine pas par une voyelle.", test: str => !/[aeiouy√†√¢√§√©√®√™√´√Ø√Æ√¥√∂√π√ª√º]$/i.test(str) },
      { text: "Doit contenir un d.", test: str => /d/i.test(str) },
      { text: "Contient la lettre i en 4√®me position.", test: str => str[3]?.toLowerCase() === 'i' },
      { text: "Contient la lettre a au moins deux fois.", test: str => (str.match(/a/gi) || []).length >= 2 },
      { text: "Ne contient pas plus de 4 voyelles.", test: str => (str.match(/[aeiouy√†√¢√§√©√®√™√´√Ø√Æ√¥√∂√π√ª√º]/gi) || []).length <= 4 },
      { text: "Doit contenir la lettre p entre les a.", test: str => /a.*p.*a/i.test(str) },
      { text: "Contient une lettre muette en derni√®re lettre.", test: str => /[tdsx]$/i.test(str) },
      { text: "Ne contient pas deux lettres identiques √† la suite.", test: str => !/(.)\1/.test(str) },
      { text: "Contient un r apr√®s un a.", test: str => /a.*r/i.test(str) },
      { text: "Ne commence pas par une voyelle.", test: str => !/^[aeiouy√†√¢√§√©√®√™√´√Ø√Æ√¥√∂√π√ª√º]/i.test(str) },
      { text: "Contient une lettre en double non c√¥te √† c√¥te.", test: str => {
          const map = {};
          for (let i = 0; i < str.length; i++) {
            const c = str[i].toLowerCase();
            if (map[c] !== undefined && i - map[c] > 1) return true;
            map[c] = i;
          }
          return false;
        }},
      { text: "Contient une voyelle avec un accent aigu.", test: str => /[√©]/i.test(str) },
      { text: "La lettre r est la 8e lettre.", test: str => str[7]?.toLowerCase() === 'r' },
      { text: "Le mot exact est : M√©diapart", test: str => str === "M√©diapart" }
    ];

    let step = 0, attempts = 0;
    const startTime = Date.now();

    const answerInput = document.getElementById("answerInput");
    const submitBtn = document.getElementById("submitBtn");
    const messageDiv = document.getElementById("message");
    const rulesList = document.getElementById("rulesList");
    const statsDiv = document.getElementById("stats");

    function showRules(input) {
      rulesList.innerHTML = "";
      for (let i = 0; i <= step; i++) {
        const li = document.createElement("li");
        const passed = rules[i].test(input);
        li.className = passed ? "rule-passed" : "rule-failed";
        li.textContent = rules[i].text;
        rulesList.appendChild(li);
      }
    }

    submitBtn.addEventListener("click", () => {
      const input = answerInput.value.trim();
      if (!input) return;

      attempts++;
      const allPassed = rules.slice(0, step + 1).every(rule => rule.test(input));

      if (allPassed) {
        if (step < rules.length - 1) {
          messageDiv.textContent = "‚úÖ Bien jou√©, prochaine r√®gle !";
          messageDiv.className = "success";
          step++;
        } else {
          messageDiv.innerHTML = '<span class="celebration">üéâ BRAVO ! Tu as devin√© : M√âDIAPART üéâ</span>';
          messageDiv.className = "success";
          submitBtn.disabled = true;
        }
      } else {
        messageDiv.textContent = "‚ùå Certaines r√®gles ne sont pas respect√©es.";
        messageDiv.className = "error";
      }

      showRules(input);
      statsDiv.textContent = `Tentatives : ${attempts} | Temps √©coul√© : ${Math.floor((Date.now() - startTime) / 1000)} sec`;
    });

    answerInput.addEventListener("keypress", e => {
      if (e.key === "Enter") submitBtn.click();
    });

    // Affiche la premi√®re r√®gle au d√©marrage
    showRules("");
  </script>
</body>
</html>
