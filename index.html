<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jeu du Mot de Passe M√©diapart</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #121212;
    color: #eee;
    max-width: 600px;
    margin: 30px auto;
    padding: 20px;
  }
  input, button {
    width: 100%;
    padding: 12px;
    margin: 10px 0;
    font-size: 1rem;
  }
  button {
    background-color: #1e90ff;
    border: none;
    color: white;
    cursor: pointer;
    border-radius: 5px;
  }
  button:disabled {
    background-color: #555;
    cursor: default;
  }
  .success {
    color: #4caf50;
    font-weight: bold;
  }
  .error {
    color: #f44336;
    font-weight: bold;
  }
  .mini-game {
    margin: 20px 0;
    padding: 10px;
    background: #222;
    border-radius: 6px;
  }
  .hidden { display: none; }
  img {
    max-width: 100%;
    border-radius: 8px;
  }
</style>
</head>
<body>

<h1>Jeu du Mot de Passe : Trouve la phrase contenant "M√©diapart"</h1>
<p id="instruction">Commence par entrer ta phrase :</p>

<input type="text" id="inputPhrase" placeholder="Tape ta phrase ici..." autocomplete="off" />
<button id="validateBtn">Valider</button>

<div id="message"></div>

<div id="miniGameContainer" class="mini-game hidden"></div>

<script>
  const phraseFinale = "F√©licitation, je t'offre un abonnement M√©diapart.";

  const rules = [
    {
      description: "La phrase commence par une majuscule.",
      test: str => /^[A-Z√Ä√Ç√Ñ√â√à√ä√ã√è√é√î√ñ√ô√õ√ú√á]/.test(str)
    },
    {
      description: "La phrase contient exactement 6 mots.",
      test: str => str.trim().split(/\s+/).length === 6
    },
    {
      description: "La phrase contient une virgule.",
      test: str => /,/.test(str)
    },
    {
      description: "La phrase contient le mot 'abonnement'.",
      test: str => /\babonnement\b/i.test(str)
    },
    {
      description: `La phrase finale est : "${phraseFinale}"`,
      test: str => str === phraseFinale
    }
  ];

  let step = 0;
  let attempts = 0;

  const inputPhrase = document.getElementById('inputPhrase');
  const validateBtn = document.getElementById('validateBtn');
  const message = document.getElementById('message');
  const miniGameContainer = document.getElementById('miniGameContainer');
  const instruction = document.getElementById('instruction');

  // Mini-jeux pour chaque √©tape sauf la derni√®re
  const miniGames = [
    function miniGameEmoji(next) {
      miniGameContainer.innerHTML = `
        <p>Mini-jeu : Clique sur l'emoji üéâ pour continuer.</p>
        <button id="emojiBtn">üéâ</button>
      `;
      miniGameContainer.classList.remove('hidden');
      document.getElementById('emojiBtn').onclick = () => {
        miniGameContainer.classList.add('hidden');
        next();
      };
    },
    function miniGameFlou(next) {
      miniGameContainer.innerHTML = `
        <p>Mini-jeu : Regarde cette image flout√©e. Devine ce que c'est, puis clique sur "J'ai devin√©" pour continuer.</p>
        <img src="https://picsum.photos/200/150?blur=8" alt="Image flout√©e" />
        <button id="guessBtn">J'ai devin√©</button>
      `;
      miniGameContainer.classList.remove('hidden');
      document.getElementById('guessBtn').onclick = () => {
        miniGameContainer.classList.add('hidden');
        next();
      };
    },
    function miniGameInclinaison(next) {
      miniGameContainer.innerHTML = `
        <p>Mini-jeu : Incline ton t√©l√©phone √† gauche, puis clique sur "OK".</p>
        <button id="inclineBtn">OK</button>
      `;
      miniGameContainer.classList.remove('hidden');
      document.getElementById('inclineBtn').onclick = () => {
        miniGameContainer.classList.add('hidden');
        next();
      };
    },
    function miniGameSecret(next) {
      miniGameContainer.innerHTML = `
        <p>Mini-jeu : Tape le mot secret <strong>MEDIAPART</strong> en majuscules puis clique sur valider.</p>
        <input type="text" id="secretInput" placeholder="Tape MEDIAPART ici" autocomplete="off" />
        <button id="secretBtn" disabled>Valider</button>
      `;
      miniGameContainer.classList.remove('hidden');

      const secretInput = document.getElementById('secretInput');
      const secretBtn = document.getElementById('secretBtn');

      secretInput.addEventListener('input', () => {
        secretBtn.disabled = secretInput.value !== "MEDIAPART";
      });
      secretBtn.onclick = () => {
        miniGameContainer.classList.add('hidden');
        next();
      };
    }
  ];

  function showMessage(text, isError = false) {
    message.textContent = text;
    message.className = isError ? 'error' : 'success';
  }

  function nextStep() {
    step++;
    if (step >= rules.length) {
      showMessage("üéâ Tu as r√©ussi √† trouver la phrase finale parfaite ! Bravo ! üéâ");
      inputPhrase.disabled = true;
      validateBtn.disabled = true;
      instruction.textContent = "Jeu termin√©.";
      return;
    }
    instruction.textContent = `√âtape ${step + 1} : ${rules[step].description}`;
    inputPhrase.value = "";
    inputPhrase.focus();
  }

  validateBtn.onclick = () => {
    const val = inputPhrase.value.trim();
    if (!val) {
      showMessage("‚ùå Entre une phrase.", true);
      return;
    }

    attempts++;

    if (!rules[step].test(val)) {
      showMessage(`‚ùå La phrase ne respecte pas la r√®gle : ${rules[step].description}`, true);
      return;
    }

    showMessage("‚úÖ R√®gle valid√©e ! Passons au mini-jeu...");

    // Lancer mini-jeu si ce n'est pas la derni√®re √©tape
    if (step < miniGames.length) {
      miniGames[step](nextStep);
    } else {
      nextStep();
    }
  };

  inputPhrase.addEventListener("keypress", e => {
    if (e.key === "Enter") validateBtn.click();
  });

  // D√©marrage
  instruction.textContent = `√âtape 1 : ${rules[0].description}`;
  inputPhrase.focus();
</script>

</body>
</html>
